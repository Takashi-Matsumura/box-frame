# 評価基準1: 結果評価（Results Evaluation）

## 概要

結果評価は、所属組織の業績達成度に基づいて算出される評価軸です。組織全体の目標達成に対する貢献度を測定します。

**特徴:**
- 評価者が個別に入力する必要はありません
- 組織の達成率から自動的にスコアが算出されます
- 客観的な数値に基づく評価です

---

## 評価の仕組み

### データソース

結果評価のスコアは、以下のデータから自動計算されます：

| 項目 | 説明 |
|------|------|
| **目標値** | 組織に設定された営業利益目標（千円） |
| **実績値** | 評価期間終了時の営業利益実績（千円） |
| **達成率** | 実績 ÷ 目標 × 100（%） |

### 組織の優先順位

社員の所属に応じて、以下の優先順位で組織データが適用されます：

1. **課（Course）** - 課に所属している場合、課の達成率を使用
2. **部（Section）** - 課がない場合、部の達成率を使用
3. **本部（Department）** - 部もない場合、本部の達成率を使用

### 間接部門の扱い

間接部門（経理、人事、総務など）は直接的な営業利益目標を持たない場合があります。その場合：

- 間接部門は「紐付け先」として他の組織（例：全社）に関連付けられます
- 紐付け先の組織の達成率が、間接部門の達成率として適用されます

**例:**
- 財務会計サービス本部（間接部門）→ 全社に紐付け
- 全社の達成率296.4% → 財務会計サービス本部の達成率として適用

---

## スコア計算ロジック

### スコア範囲の決定

結果評価のスコアは、プロセス評価・成長評価と同じスコア範囲を使用します。スコア範囲は、評価マスタに登録されたデータから**動的に決定**されます。

#### スコア範囲の算出方法

`getEvaluationScoreRange()` 関数が以下のデータを参照します：

1. **プロセス評価マスタ** - 各クラス（A〜D）のT1〜T4スコア
2. **成長評価マスタ** - 各カテゴリのT1〜T4スコア × 係数

**計算例（実際のマスタデータより）:**

| データソース | 最小値（T1） | 最大値（T4） |
|-------------|-------------|-------------|
| プロセス評価クラスA | 75 | 130 |
| プロセス評価クラスC | 60 | 110 |
| 成長評価（専門スキル×1.0） | 50 | 115 |
| 成長評価（部下指導×1.3） | 60 | 130 |

→ **min = 50**（全体の最小値）、**max = 130**（全体の最大値）、**range = 80**

---

### スコア範囲を4ゾーンに分割

スコア範囲（min〜max）を**4等分**して、達成率の各区間と対応させます。

```
スコア範囲: 50 ────────────────────────────────── 130
            │         │         │         │
           25%       50%       75%      100%
            │         │         │         │
スコア:    50        70        90       110       130
            │         │         │         │         │
            ▼         ▼         ▼         ▼         ▼
達成率:    0%       80%      100%      120%      160%
```

### 4ゾーンの対応表

| ゾーン | 達成率の範囲 | 達成率の幅 | スコアの範囲 | スコアの幅 | 評価の意味 |
|--------|-------------|-----------|-------------|-----------|-----------|
| 1 | 0% → 80% | 80% | 50 → 70 | 20 | 未達成 |
| 2 | 80% → 100% | 20% | 70 → 90 | 20 | ほぼ達成 |
| 3 | 100% → 120% | 20% | 90 → 110 | 20 | 目標達成〜超過 |
| 4 | 120% → 160% | 40% | 110 → 130 | 20 | 大幅超過 |

**ポイント:**
- 達成率100%（標準）はスコア範囲の**中央（50%位置）**に対応
- これはプロセス評価・成長評価の**T2（標準）**と同じ位置づけ

---

### なぜ160%が上限なのか

コードの該当部分：
```typescript
} else {
  // 120%以上の場合
  const ratio = Math.min((achievementRate - 120) / 40, 1);
  normalizedScore = min + range * 0.75 + ratio * (range * 0.25);
}
```

- `(achievementRate - 120) / 40` → 120%から**40%分**進むとratioが1になる
- 120% + 40% = **160%**
- `Math.min(..., 1)` でratioは最大1に制限される
- だから**160%以上は全て最大スコア(130)に固定**される

---

### 計算式の詳細

```
スコア範囲: min = 50, max = 130, range = 80

【80%未満】
スコア = min + (達成率 / 80) × (range × 0.25)

【80%〜99%】
スコア = min + range × 0.25 + ((達成率 - 80) / 20) × (range × 0.25)

【100%〜119%】
スコア = min + range × 0.50 + ((達成率 - 100) / 20) × (range × 0.25)

【120%〜159%】
スコア = min + range × 0.75 + ((達成率 - 120) / 40) × (range × 0.25)

【160%以上】
スコア = max（上限値で固定）
```

### 計算例

**達成率 50% の場合:**
```
スコア = 50 + (50 / 80) × (80 × 0.25)
      = 50 + 0.625 × 20
      = 50 + 12.5
      = 62.5
```

**達成率 100% の場合:**
```
スコア = 50 + 80 × 0.50
      = 50 + 40
      = 90（スコア範囲の中央値）
```

**達成率 120% の場合:**
```
スコア = 50 + 80 × 0.75 + 0 × 20
      = 50 + 60
      = 110
```

**達成率 160% の場合:**
```
ratio = (160 - 120) / 40 = 1（上限）
スコア = 50 + 80 × 0.75 + 1 × 20
      = 50 + 60 + 20
      = 130（最大値）
```

**達成率 296% の場合:**
```
160%以上なので上限適用
スコア = 130（最大値で固定）
```

---

## 重み付け

結果評価のスコアは、資格等級に応じた重みで最終スコアに反映されます。

| 資格等級 | 結果評価の重み | 説明 |
|----------|---------------|------|
| G1-G2（一般） | 20% | 個人の成長重視 |
| G3-G4（主任級） | 30% | バランス型 |
| G5-G6（管理職） | 40% | 組織成果重視 |
| G7以上（上級管理職） | 50% | 組織成果最重視 |

**例:** 結果評価スコア 110.0、重み 40% の場合
```
加重スコア = 110.0 × 0.40 = 44.00
```

---

## よくある質問

### Q1: 結果評価のスコアを評価者が変更できますか？

**A:** 基本的にはできません。結果評価は組織の達成率から自動計算されるため、客観性が担保されています。ただし、特別な事情がある場合は、管理者が「評価マスタ」画面で達成率を調整することが可能です。

### Q2: 所属組織の達成率が登録されていない場合はどうなりますか？

**A:** 達成率が未登録の場合、結果評価の算定根拠に「データなし」と表示されます。この場合、管理者に連絡して達成率データの登録を依頼してください。

### Q3: 異動した場合、どの組織の達成率が適用されますか？

**A:** 評価期間終了時点の所属組織の達成率が適用されます。期中に異動があった場合でも、評価時点の所属が基準となります。

### Q4: 達成率が160%を超えても最大スコアで頭打ちになるのはなぜですか？

**A:** 以下の理由から上限を設けています：
1. **他の評価軸との公平性**: プロセス評価・成長評価にも上限があるため
2. **極端な数値の排除**: 異常値が最終評価を歪めることを防止
3. **評価の正規化**: 3軸を同じスコア範囲で比較・合算するため
4. **160%の根拠**: スコア範囲を4等分し、第4ゾーン（120%〜）に40%幅を割り当てた結果

### Q5: 間接部門の紐付け先はどのように決まりますか？

**A:** 管理者が「評価マスタ」の「結果評価」タブで設定します。一般的には：
- 全社（COMPANY）に紐付け：全社の業績に連動
- 特定の直接部門に紐付け：その部門の業績に連動

---

## 評価者へのアドバイス

### 結果評価に関するコメントのポイント

結果評価は自動計算ですが、評価者はコメントで補足説明を加えることができます：

1. **達成に至った要因の分析**
   - 「市場環境の好転」「新規顧客の獲得」など

2. **個人の貢献度の補足**
   - 「チームの中核として売上拡大に貢献」
   - 「コスト削減施策の推進により利益率改善に寄与」

3. **未達成の場合の背景説明**
   - 「予期せぬ市場変化への対応」
   - 「長期投資による一時的な利益減少」

### 注意点

- 結果評価はあくまで「組織の成果」であり、個人の努力と必ずしも一致しない場合があります
- プロセス評価・成長評価と組み合わせることで、総合的な評価が可能になります
- 達成率だけでなく、その過程や質的な側面もコメントで補足しましょう
